const data = [
    {
        "Grado": 4,
        "Nombre": "ROBERT DANIEL DE LEON DELGADO",
        "C.I": "30518617"
    },
    {
        "Grado": 4,
        "Nombre": "DARIO ALEJANDRO ARAUJO CALERO",
        "C.I": "34331386"
    },
    {
        "Grado": 4,
        "Nombre": "MARCELO ANDRES LEONE OTORMIN",
        "C.I": "30775764"
    },
    {
        "Grado": 4,
        "Nombre": "MIGUEL ANGEL MEDINA GARCIA",
        "C.I": "30516562"
    },
    {
        "Grado": 4,
        "Nombre": "JOSE TEIXEIRA ARRIGONNI",
        "C.I": "40819176"
    },
    {
        "Grado": 3,
        "Nombre": "EDUARDO MARCELO IROLDI AMARILLA",
        "C.I": "26709795"
    },
    {
        "Grado": 3,
        "Nombre": "RODRIGO SEBASTIAN BEGUIRISTAIN RIOS",
        "C.I": "47778943"
    },
    {
        "Grado": 3,
        "Nombre": "NESTOR EDGARDO REYES ACOSTA",
        "C.I": "25464285"
    },
    {
        "Grado": 3,
        "Nombre": "PAULINO JAVIER VIDAL URRETA",
        "C.I": "38221119"
    },
    {
        "Grado": 3,
        "Nombre": "JAVIER DARIO DANGELO BARTOLOTTA",
        "C.I": "40847246"
    },
    {
        "Grado": 3,
        "Nombre": "MARCOS GABRIEL RODRIGUEZ RECCIOPPE",
        "C.I": "44291681"
    },
    {
        "Grado": 3,
        "Nombre": "BRIAN NICOLAS LOPEZ DALUZ",
        "C.I": "43805857"
    },
    {
        "Grado": 3,
        "Nombre": "FERNANDO GASTON MEDEROS MAIDANA",
        "C.I": "42831990"
    },
    {
        "Grado": 3,
        "Nombre": "MARIELA VILORIA NUÑEZ",
        "C.I": "31858199"
    },
    {
        "Grado": 2,
        "Nombre": "LUCIO CAETANO CABALLERO PIRIZ",
        "C.I": "42263854"
    },
    {
        "Grado": 2,
        "Nombre": "ADRIAN FRANCISCO TERRA IGNACIO",
        "C.I": "35851383"
    },
    {
        "Grado": 2,
        "Nombre": "ALEXANDER ANDRES POMBO BEROIS",
        "C.I": "51425055"
    },
    {
        "Grado": 2,
        "Nombre": "JUAN MARTIN MERLO PEREZ",
        "C.I": "35667198"
    },
    {
        "Grado": 2,
        "Nombre": "ALBERTO GABRIEL NOBLE LEMOS",
        "C.I": "35508534"
    },
    {
        "Grado": 2,
        "Nombre": "ESTEBAN DANIEL MURCHIO HERNANDEZ",
        "C.I": "47554442"
    },
    {
        "Grado": 2,
        "Nombre": "MATHIAS CONO MAZZETTI SALAZAR",
        "C.I": "48681533"
    },
    {
        "Grado": 2,
        "Nombre": "DANILO MARIO GALLERO TORRES",
        "C.I": "43951723"
    },
    {
        "Grado": 2,
        "Nombre": "ENZO JAVIER FERRAZ QUIROGA",
        "C.I": "17930535"
    },
    {
        "Grado": 2,
        "Nombre": "LEONARDO FABIAN ZULUETA CALISIOTTI",
        "C.I": "46485129"
    },
    {
        "Grado": 2,
        "Nombre": "BRUNO DORNELLES GUTIERREZ",
        "C.I": "46947761"
    },
    {
        "Grado": 2,
        "Nombre": "MILTON DANILO BERRIEL ESPINO",
        "C.I": "43340360"
    },
    {
        "Grado": 2,
        "Nombre": "PABLO SEBASTIAN MADERA CAMACHO",
        "C.I": "26278247"
    },
    {
        "Grado": 2,
        "Nombre": "EDGAR DARIO DI BIANCO",
        "C.I": "30909086"
    },
    {
        "Grado": 2,
        "Nombre": "ENZO DA SILVA VASCONCELLOS",
        "C.I": "42780563"
    },
    {
        "Grado": 2,
        "Nombre": "MARCOS NUÑEZ PICANZO",
        "C.I": "47756193"
    },
    {
        "Grado": 2,
        "Nombre": "MILTON DANILO BERRIEL ESPINO",
        "C.I": "47131399"
    },
    {
        "Grado": 2,
        "Nombre": "RAFAEL MERNIES GONZALEZ",
        "C.I": "32530572"
    },
    {
        "Grado": 2,
        "Nombre": "BRAULIO CEDRES BARRETO",
        "C.I": "42362476"
    },
    {
        "Grado": 1,
        "Nombre": "LUIS FERNANDO RODRIGUEZ SENI",
        "C.I": "46688294"
    },
    {
        "Grado": 1,
        "Nombre": "MARCOS CESAR LIMA ROYANO",
        "C.I": "45049118"
    },
    {
        "Grado": 1,
        "Nombre": "JOSE MARIA AMARILLO",
        "C.I": "26066139"
    },
    {
        "Grado": 1,
        "Nombre": "DILAN RECALDE REMEDIOS",
        "C.I": "54531427"
    },
    {
        "Grado": 1,
        "Nombre": "ANA KARINA PIRIZ TIRON",
        "C.I": "34286298"
    },
    {
        "Grado": 1,
        "Nombre": "LUIS ALFREDO BAES FERNANDEZ",
        "C.I": "48561858"
    },
    {
        "Grado": 1,
        "Nombre": "CRISTIAN DANIEL OLIVERA GONZALEZ",
        "C.I": "49460869"
    },
    {
        "Grado": 1,
        "Nombre": "ANDREE MICHAEL SENA MOLLO",
        "C.I": "34707765"
    },
    {
        "Grado": 1,
        "Nombre": "ARIEL VICTOR SILVA LAPORTA",
        "C.I": "39736793"
    },
    {
        "Grado": 1,
        "Nombre": "VERONICA INES YANIBELLI GARCIA",
        "C.I": "45148962"
    },
    {
        "Grado": 1,
        "Nombre": "IGNACIO GERVASINI",
        "C.I": "52202656"
    },
    {
        "Grado": 1,
        "Nombre": "BRUNO MAXIMILIANO MAGALLAN JORAJURA",
        "C.I": "46147345"
    },
    {
        "Grado": 1,
        "Nombre": "JONATAN NAHUEL VICENTE DOMINGUEZ",
        "C.I": "53217315"
    },
    {
        "Grado": 1,
        "Nombre": "PABLO CRISTINO FAGUNDEZ",
        "C.I": "46381648"
    },
    {
        "Grado": 1,
        "Nombre": "LUCAS SEBASTIAN ALMEIDA LOPEZ",
        "C.I": "54428276"
    },
    {
        "Grado": 1,
        "Nombre": "FACUNDO AGUSTIN MURAÑA RIVERO",
        "C.I": "49849572"
    },
    {
        "Grado": 1,
        "Nombre": "JONATHAN NOEL PINATO COLMAN",
        "C.I": "50912231"
    },
    {
        "Grado": 1,
        "Nombre": "ATANASILDO PEREZ CAMPO",
        "C.I": "26234590"
    },
    {
        "Grado": 1,
        "Nombre": "MARTIN ENRIQUE MUNIZ CASTRO",
        "C.I": "44604377"
    },
    {
        "Grado": 1,
        "Nombre": "ALFREDO ENRIQUE OLIVERA BAZAN",
        "C.I": "41835490"
    },
    {
        "Grado": 1,
        "Nombre": "GONZALO PEREZ SANCHEZ",
        "C.I": "50717970"
    },
    {
        "Grado": 1,
        "Nombre": "CAMILO PROTTI",
        "C.I": "50668284"
    },
    {
        "Grado": 1,
        "Nombre": "FEDERICO NICOLAS BENITEZ SILVERA",
        "C.I": "51100718"
    },
    {
        "Grado": 1,
        "Nombre": "CESAR GOMEZ BORDAGORRY",
        "C.I": "50724539"
    },
    {
        "Grado": 1,
        "Nombre": "JUAN GONZALEZ",
        "C.I": "55147041"
    },
    {
        "Grado": 1,
        "Nombre": "ALFREDO DAVID PEREYRA SIERRA",
        "C.I": "52466052"
    },
    {
        "Grado": 1,
        "Nombre": "NICOLAS LEONEL DIAZ MUÑOZ",
        "C.I": "46759837"
    },
    {
        "Grado": 1,
        "Nombre": "RODOLFO RAMON DENIZ MARCENAL",
        "C.I": "39989437"
    },
    {
        "Grado": 1,
        "Nombre": "ALEXANDER FACUNDO ROLANDE SOUZA",
        "C.I": "51550181"
    },
    {
        "Grado": 1,
        "Nombre": "DIEGO ABEL SILVEIRA AREVALO",
        "C.I": "46518285"
    },
    {
        "Grado": 1,
        "Nombre": "ANDRES BLECICH",
        "C.I": "55086150"
    },
    {
        "Grado": 1,
        "Nombre": "CHRISTIAN ALEXIS FERNANDEZ GARCIA",
        "C.I": "46736566"
    },
    {
        "Grado": 1,
        "Nombre": "MAXIMILIANO EZEQUIEL MEDINA MONTES",
        "C.I": "48732023"
    },
    {
        "Grado": 1,
        "Nombre": "MICHAEL BERMUDEZ",
        "C.I": "54021822"
    },
    {
        "Grado": 1,
        "Nombre": "VALENTINA NUÑEZ CHALART",
        "C.I": "46014308"
    },
    {
        "Grado": 1,
        "Nombre": "MATIAS CARRION DIAZ",
        "C.I": "53645580"
    },
    {
        "Grado": 1,
        "Nombre": "FEDERICO VINCENT BUVE MARICHAL",
        "C.I": "46789654"
    },
    {
        "Grado": 1,
        "Nombre": "EDUARDO DARIO FARIAS PERDOMO",
        "C.I": "53268198"
    },
    {
        "Grado": 1,
        "Nombre": "JONATHAN DANIEL MARQUEZ MARQUEZ",
        "C.I": "52059354"
    },
    {
        "Grado": 1,
        "Nombre": "PABLO MARTIN PEREIRA PEREIRA",
        "C.I": "50482771"
    },
    {
        "Grado": 1,
        "Nombre": "WASHINGTON ALEXANDER PIÑEIRO FERRO",
        "C.I": "53471777"
    },
    {
        "Grado": 1,
        "Nombre": "MARXIO WILMAR CABRERA SMITH",
        "C.I": "48057928"
    },
    {
        "Grado": 1,
        "Nombre": "MARCOS NAHUEL RECONDO REYES",
        "C.I": "51051367"
    },
    {
        "Grado": 1,
        "Nombre": "LUCAS GASPARIK ARADA",
        "C.I": "55087853"
    },
    {
        "Grado": 1,
        "Nombre": "CHRISTIAN EDUARDO CASTRO PEREZ",
        "C.I": "53266134"
    },
    {
        "Grado": 1,
        "Nombre": "DIEGO EZEQUIEL ROVIRA MACHADO",
        "C.I": "49694852"
    },
    {
        "Grado": 1,
        "Nombre": "CAMILA VAZLLAGUNO",
        "C.I": "49473256"
    },
    {
        "Grado": 1,
        "Nombre": "MARIA ALEJANDRA ESTEVEZ RAMOS",
        "C.I": "48901858"
    },
    {
        "Grado": 1,
        "Nombre": "GIAN GIACOBONI",
        "C.I": "48626212"
    },
    {
        "Grado": 1,
        "Nombre": "PABLO GERMAN NICOLAS RODRIGUEZ",
        "C.I": "51112054"
    },
    {
        "Grado": 1,
        "Nombre": "VICTOR IVAN FARIAS FERREIRA",
        "C.I": "49132038"
    },
    {
        "Grado": 1,
        "Nombre": "STEFANIA ABANONI",
        "C.I": "45815147"
    },
    {
        "Grado": 1,
        "Nombre": "EMILIANO FORLANO GONZALEZ",
        "C.I": "51015377"
    },
    {
        "Grado": 1,
        "Nombre": "MARIA VICTORIA RODRIGUEZ DIAZ",
        "C.I": "47328241"
    },
    {
        "Grado": 1,
        "Nombre": "EDUARD MARTIN ALMEIDA GONZALEZ",
        "C.I": "51458705"
    },
    {
        "Grado": 1,
        "Nombre": "CRISTIAN EMANUEL MARTINEZ MENYOU",
        "C.I": "52852631"
    },
    {
        "Grado": 1,
        "Nombre": "RODRIGO PEREZ CORREA",
        "C.I": "50998132"
    },
    {
        "Grado": 1,
        "Nombre": "LUCIA PEREZ CASTRO",
        "C.I": "54064779"
    },
    {
        "Grado": 1,
        "Nombre": "BRUNO ARIAS SUAREZ",
        "C.I": "52396322"
    },
    {
        "Grado": 1,
        "Nombre": "MATHIAS ABREU ESPOSITO",
        "C.I": "47323207"
    },
    {
        "Grado": 1,
        "Nombre": "JULIA MARIA de ARMAS QUIMBO",
        "C.I": "50316508"
    },
    {
        "Grado": 1,
        "Nombre": "ROBERTO MARTIN BALADAN TEJEDOR",
        "C.I": "38806290"
    },
    {
        "Grado": 1,
        "Nombre": "ANA CAROLINA BRAZ FERNANDEZ",
        "C.I": "52639980"
    },
    {
        "Grado": 1,
        "Nombre": "RUBEN DAVID COCOREL DE LOS SANTOS",
        "C.I": "53261582"
    },
    {
        "Grado": 1,
        "Nombre": "PABLO JAVIER CORREA CORRALES",
        "C.I": "49447883"
    },
    {
        "Grado": 1,
        "Nombre": "ANGIE LORELEY DA ROSA MACEDO",
        "C.I": "54341222"
    },
    {
        "Grado": 1,
        "Nombre": "EZEQUIEL DOS SANTOS DE LOS SANTOS",
        "C.I": "54223636"
    },
    {
        "Grado": 1,
        "Nombre": "BRANDON NAHUEL EMANUELE FERRADA",
        "C.I": "54773471"
    },
    {
        "Grado": 1,
        "Nombre": "SEBASTIAN FRANCIA",
        "C.I": "52894073"
    },
    {
        "Grado": 1,
        "Nombre": "MACARENA GARCILAZO",
        "C.I": "49893818"
    },
    {
        "Grado": 1,
        "Nombre": "KATYA NICOL GOMEZ INZAURRALDE",
        "C.I": "51077298"
    },
    {
        "Grado": 1,
        "Nombre": "JUAN IGNACIO GONZALEZ BLANCO",
        "C.I": "55147041"
    },
    {
        "Grado": 1,
        "Nombre": "GERARDO MARTIN GONZALEZ CALDERON",
        "C.I": "49967425"
    },
    {
        "Grado": 1,
        "Nombre": "ALBERTO GERMAN GONZALEZ CHIRICO",
        "C.I": "53846083"
    },
    {
        "Grado": 1,
        "Nombre": "ROMINA MICAEL GONZALEZ RIVERO",
        "C.I": "54902000"
    },
    {
        "Grado": 1,
        "Nombre": "ALFONSO MATIAS GUTIERREZ ALDERETE",
        "C.I": "47290458"
    },
    {
        "Grado": 1,
        "Nombre": "ALEX DANIEL LATORRE COLMAN",
        "C.I": "49107772"
    },
    {
        "Grado": 1,
        "Nombre": "FLORENCIA ESTEFANIA MACHADO GOMEZ",
        "C.I": "55284015"
    },
    {
        "Grado": 1,
        "Nombre": "DIEGO IGNACIO MILICHI VARGAS",
        "C.I": "49423223"
    },
    {
        "Grado": 1,
        "Nombre": "EMANUEL MOLINÉ SUAREZ",
        "C.I": "54148072"
    },
    {
        "Grado": 1,
        "Nombre": "CECILIA BELEN MORALES PICARDO",
        "C.I": "53557896"
    },
    {
        "Grado": 1,
        "Nombre": "RYAN MICHAEL NAVAS ROSAS",
        "C.I": "53216117"
    },
    {
        "Grado": 1,
        "Nombre": "CRISTIAN FEDERICO NEVES RODRIGUEZ",
        "C.I": "51033052"
    },
    {
        "Grado": 1,
        "Nombre": "DIEGO NICOLAS OLIVERA SILVEIRA",
        "C.I": "53593375"
    },
    {
        "Grado": 1,
        "Nombre": "DIEGO MARTIN PAMPILLON PEREYRA",
        "C.I": "53677151"
    },
    {
        "Grado": 1,
        "Nombre": "ANDRES ALEXIS PERDOMO LORENZO",
        "C.I": "48702115"
    },
    {
        "Grado": 1,
        "Nombre": "SILVIO MAURICIO PEREIRA PINTOS",
        "C.I": "51019157"
    },
    {
        "Grado": 1,
        "Nombre": "EMELY ESTEFANY PEREYRA SILVA",
        "C.I": "53455551"
    },
    {
        "Grado": 1,
        "Nombre": "GABRIEL ALEJANDRO PRETO SANDOVAL",
        "C.I": "47584388"
    },
    {
        "Grado": 1,
        "Nombre": "CAMILO ALFONSO PROTTI GODIÑO",
        "C.I": "50668284"
    },
    {
        "Grado": 1,
        "Nombre": "CYNTHIA BELEN RAMOS PACHECO",
        "C.I": "54287038"
    },
    {
        "Grado": 1,
        "Nombre": "SABRINA SOLEDAD RAMOS TORRES",
        "C.I": "46603143"
    },
    {
        "Grado": 1,
        "Nombre": "BRUNO MAURICIO RIBEIRO SEVERO",
        "C.I": "51776442"
    },
    {
        "Grado": 1,
        "Nombre": "JOEL RODRIGUEZ ABELLAN",
        "C.I": "54003749"
    },
    {
        "Grado": 1,
        "Nombre": "GUSTAVO DANIEL RODRIGUEZ ACOSTA",
        "C.I": "48836673"
    },
    {
        "Grado": 1,
        "Nombre": "RICHARD MAXIMILIANO RODRIGUEZ ESTEVEZ",
        "C.I": "48740567"
    },
    {
        "Grado": 1,
        "Nombre": "FIAMA ALEJANDRA RODRIGUEZ FERREIRA",
        "C.I": "52595281"
    },
    {
        "Grado": 1,
        "Nombre": "LEONARDO SANTIAGO RODRIGUEZ FONSECA",
        "C.I": "49229386"
    },
    {
        "Grado": 1,
        "Nombre": "ISAIAS RODRIGUEZ RODRIGUEZ",
        "C.I": "54905977"
    },
    {
        "Grado": 1,
        "Nombre": "FEDERICO ANDRES SALVARREY VAZQUEZ",
        "C.I": "53843677"
    },
    {
        "Grado": 1,
        "Nombre": "ALEJANDRO TOBIAS SANCHES CUESTAS",
        "C.I": "51011575"
    },
    {
        "Grado": 1,
        "Nombre": "CAMILA VALERIA SANTOS RODRIGUEZ",
        "C.I": "50017023"
    },
    {
        "Grado": 1,
        "Nombre": "ARIANA SANTURIO GONZALEZ",
        "C.I": "53408489"
    },
    {
        "Grado": 1,
        "Nombre": "EVER EXEQUIEL SOSA PEREIRA",
        "C.I": "55865849"
    },
    {
        "Grado": 1,
        "Nombre": "JOAQUIN NICOLAS TORRES GIMENEZ",
        "C.I": "51233460"
    },
    {
        "Grado": 1,
        "Nombre": "MARTIN EMANUEL VEGA GOMEZ",
        "C.I": "47167916"
    },
    {
        "Grado": 1,
        "Nombre": "ANIBAL ADRIAN VIERA TEJERA",
        "C.I": "46677770"
    },
    {
        "Grado": 1,
        "Nombre": "EDISNON GABRIEL VILLALBA MONZON",
        "C.I": "51212824"
    },
    {
        "Grado": 1,
        "Nombre": "LUIS JONATHAN COSTA PAIVA",
        "C.I": "45814911"
    },
    {
        "Grado": 1,
        "Nombre": "BRAULIO ANDRES CEDRES BARRETO",
        "C.I": "42362476"
    },
    {
        "Grado": 1,
        "Nombre": "JUAN PAIS",
        "C.I": "49799343"
    },
    {
        "Grado": 1,
        "Nombre": "YONATHAN SALDIVIA BRAGA",
        "C.I": "50694942"
    },
     {
        "Grado": 3,
        "Nombre": "ANIBAL ALVARIZA",
        "C.I": "37773791"
    }
    
];

const moviles = [
    "SMI6042-063",
    "SMI6110-062",
    "SMI1311(BASE MOVIL)",
    "SMI5439-046",
    "SMI5269-015",
    "SMI5361-064",
    "SMI1313-068",
    "SMI5969-019",
    "SMI3793-013",
    "SMI6115-035",
    "SMI5823-082",
    "SMI5324-080",
    "SMI5761-047",
    "SMI6118-048",
    "SMI5300-042",
    "SMI6113-018",
    "SMI6111-081",
    "MIS05882-033",
    "SMI5543-044",
    "SMI5506-06",
    "SMI5338-038",
    "SMI1113-005",
    "SMI3834-014",
“SPN238”,
“SPN404”,
“SPN529”,
“SPN509”,
“SPN518”,
“SPN526”,
“SPN512”,
“SPN514”,
“SPN516”,
“SPN523”,
“SPN532”,
“SPN524”,
“SPN369”,
“SPN390”,
“SPN391”

];

const searchInput = document.getElementById("searchInput");
const searchResults = document.getElementById("searchResults");
const turnoSelect = document.getElementById("turnoSelect");
const fechaInput = document.getElementById("fechaInput");
const movilInput = document.getElementById("movilInput");
const movilResults = document.getElementById("movilResults");
const addButton = document.getElementById("addButton");
const guardarButton = document.getElementById("guardarButton");
const addedList = document.getElementById("addedList");

let selectedPerson = null;
let addedPeople = [];

// ================== HELPERS ==================
function splitName(fullName) {
    const parts = fullName.split(" ");
    return {
        firstName: parts[0],
        lastName: parts.slice(1).join(" ")
    };
}

// ================== BUSCADOR NOMBRES ==================
searchInput.addEventListener("input", () => {
    const value = searchInput.value.toUpperCase().trim();
    searchResults.innerHTML = "";
    selectedPerson = null;

    if (!value) return;

    data
        .filter(p => p.Nombre.includes(value))
        .forEach(person => {
            const div = document.createElement("div");
            div.textContent = person.Nombre;

            div.onclick = () => {
                selectedPerson = person;
                searchInput.value = person.Nombre;
                searchResults.innerHTML = "";

                turnoSelect.disabled = false;
            };

            searchResults.appendChild(div);
        });
});

// ================== TURNO ==================
turnoSelect.addEventListener("change", () => {
    if (turnoSelect.value) {
        fechaInput.disabled = false;
    }
});

// ================== FECHA ==================
fechaInput.addEventListener("change", () => {
    if (fechaInput.value) {
        addButton.style.display = "block";
    }
});

// ================== BUSCADOR MÓVILES ==================
movilInput.addEventListener("input", () => {
    const value = movilInput.value.toLowerCase().trim();
    movilResults.innerHTML = "";

    if (!value) return;

    moviles
        .filter(m => m.toLowerCase().includes(value))
        .forEach(movil => {
            const div = document.createElement("div");
            div.textContent = movil;

            div.onclick = () => {
                movilInput.value = movil;
                movilResults.innerHTML = "";
            };

            movilResults.appendChild(div);
        });
});

// ================== AGREGAR ==================
addButton.addEventListener("click", () => {
    if (!selectedPerson || !movilInput.value || !turnoSelect.value || !fechaInput.value) {
        alert("Complete todos los campos");
        return;
    }

    const { firstName, lastName } = splitName(selectedPerson.Nombre);

    addedPeople.push({
        Grado: selectedPerson.Grado,
        Nombre: firstName,
        Apellido: lastName,
        "C.I": selectedPerson["C.I"],
        Movil: movilInput.value,
        Turno: turnoSelect.value,
        Fecha: fechaInput.value
    });

    renderAddedList();

    // Reset
    selectedPerson = null;
    searchInput.value = "";
    movilInput.value = "";
    turnoSelect.value = "";
    turnoSelect.disabled = true;
    // fechaInput.value = "";
     //fechaInput.disabled = true;
    addButton.style.display = "none";
});

// ================== LISTA ==================
function renderAddedList() {
    addedList.innerHTML = "";

    addedPeople.forEach((p, i) => {
        const li = document.createElement("li");
        li.innerHTML = `
            ${p.Nombre} ${p.Apellido}<br>
            Turno ${p.Turno} - ${p.Movil}
        `;

        const btn = document.createElement("button");
        btn.textContent = "Eliminar";
        btn.onclick = () => {
            addedPeople.splice(i, 1);
            renderAddedList();
        };

        li.appendChild(btn);
        addedList.appendChild(li);
    });

    document.getElementById("addedListContainer").style.display =
        addedPeople.length ? "block" : "none";
}

// ================== GUARDAR ==================
guardarButton.addEventListener("click", () => {
    if (!addedPeople.length) {
        alert("No hay datos");
        return;
    }

    const ws = XLSX.utils.json_to_sheet(addedPeople);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Datos");
    XLSX.writeFile(wb, "datos_turnos.xlsx");
});
